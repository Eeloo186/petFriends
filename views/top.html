<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>{{title}}</title>
    <meta name="viewport" content="width=device-width, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="/styles/top.css" />
  </head>
  <body>
    <div id="menu-box">
      <div id="myPage">
        {% if user %}
        <a href="" id="myPage-btn">{{ user.nickname }} 님</a>
        <div id="mypage-box">
          <a href="/page/mypage" id="mypage-btn"> 마이페이지 </a>
        </div>
        <div id="nomarl-logout">
          <a id="logout" href="/auth/logout">로그아웃</a>
        </div>
       
        {% if user.provider == 'kakao' %}
        <div id="kakaoLogout-box">
          <a
            id="kakaoLogout"
            href="https://kauth.kakao.com/oauth/logout?client_id=d45b50b3b88e8033a6e47e1c9e7d43d8&logout_redirect_uri=http://localhost:8001/auth/logout"
            ><img src="/imgs/kakaologout.png" alt="" /> 로그아웃</a
          >
        </div>
        {% endif %} {% else %}
      
        <div id="login-box">
          <a href="/auth/login" id="login-btn"> 로그인 </a>
        </div>

        {% endif %}
      </div>
      <div id="logo-box">
        <h1><a href="/">PET FRIENTS</a></h1>
        {% if user %}
       <p> {{ user.nickname }} 님 </p>
        {% endif %}
      </div>
      <div>
        <ul id="menu-list">
          <li>
            <a href="/page/notice?currentPage=1">공지사항</a>
          </li>
          <li>
            <a href="/page/info?currentPage=1">정보글</a>
          </li>
          <li>
            <a href="/page/community?currentPage=1">커뮤니티</a>
          </li>
        </ul>
      </div>
    </div>
    <div class="weather-area">
      <textarea id="weather-textbox"></textarea>
    </div>

    {% block content %} {% endblock %}
  </body>
  {% block script %}
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script>
    window.onload = async function () {
      console.log("top.html 로딩 완료");
      if ("{{user}}") {
        await axios
          .get("/api/weather/{{user.id}}")
          .then((res) => {
            console.log(res.data);
            const weatherArea = document.getElementById("weather-textbox");
            weatherArea.value = `기온 : ${res.data.temp}, 강수확률 : ${res.data.pop}`;
          })
          .catch((err) => {
            console.log("에러 발생");
            console.error(err);
          });
      }
    };
  </script>
  {% endblock %}
</html>
